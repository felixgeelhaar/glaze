import { Meta } from '@storybook/blocks';

<Meta title="Documentation/Accessibility" />

# Accessibility Guidelines

Glaze is built with accessibility as a core principle, following WCAG 2.2 Level AA standards.

## WCAG 2.2 AA Compliance Checklist

### ✅ Perceivable

#### 1.1 Text Alternatives
- ✅ All interactive elements have accessible names
- ✅ Icons include `aria-label` when used alone
- ✅ Decorative elements marked with `aria-hidden="true"`

#### 1.3 Adaptable
- ✅ Semantic HTML structure maintained
- ✅ Form inputs properly associated with labels
- ✅ Landmark regions properly defined

#### 1.4 Distinguishable
- ✅ **Color Contrast**: 
  - Normal text: 4.5:1 minimum
  - Large text: 3:1 minimum
  - Interactive elements: 3:1 minimum
- ✅ Text resizable up to 200% without loss of functionality
- ✅ Content reflows at 320px viewport width

### ✅ Operable

#### 2.1 Keyboard Accessible
- ✅ All interactive elements keyboard accessible
- ✅ No keyboard traps
- ✅ Logical tab order maintained
- ✅ Skip links available for navigation

#### 2.4 Navigable
- ✅ Focus indicators clearly visible
- ✅ Page titles descriptive
- ✅ Headings properly nested
- ✅ Link purpose clear from context

#### 2.5 Input Modalities
- ✅ Touch targets minimum 44x44 pixels
- ✅ Drag functionality has keyboard alternative
- ✅ Motion actuation has UI control alternative

### ✅ Understandable

#### 3.1 Readable
- ✅ Language of page identified
- ✅ Clear, simple language used

#### 3.2 Predictable
- ✅ Navigation consistent across pages
- ✅ Components behave predictably
- ✅ No automatic context changes on focus

#### 3.3 Input Assistance
- ✅ Error messages clear and specific
- ✅ Labels and instructions provided
- ✅ Error prevention for important actions

### ✅ Robust

#### 4.1 Compatible
- ✅ Valid HTML markup
- ✅ ARIA used correctly
- ✅ Works with assistive technologies
- ✅ Status messages announced to screen readers

## Component-Specific Accessibility

### Button Component

```html
<!-- Accessible button with proper ARIA -->
<glz-button 
  variant="glass"
  aria-label="Save document"
  aria-pressed="false"
>
  Save
</glz-button>
```

**Features:**
- Keyboard activation (Enter, Space)
- Focus management
- ARIA states (pressed, disabled, expanded)
- Loading state announcements

### Dialog Component

```html
<!-- Accessible modal dialog -->
<glz-dialog
  open
  label="Confirmation Dialog"
  role="dialog"
  aria-modal="true"
>
  <!-- Content -->
</glz-dialog>
```

**Features:**
- Focus trap when open
- ESC key closes dialog
- Focus returns to trigger on close
- Screen reader announcements
- Backdrop click handling

### Input Component

```html
<!-- Accessible form input -->
<glz-input
  label="Email Address"
  type="email"
  required
  aria-required="true"
  aria-invalid="false"
  aria-describedby="email-helper"
>
  <span slot="helper" id="email-helper">
    Enter your work email
  </span>
</glz-input>
```

**Features:**
- Label association
- Error state announcements
- Helper text association
- Required field indication
- Validation feedback

### Navigation Component

```html
<!-- Accessible navigation -->
<glz-navbar
  role="navigation"
  aria-label="Main navigation"
>
  <nav>
    <ul role="list">
      <li><a href="#home">Home</a></li>
      <li><a href="#about">About</a></li>
    </ul>
  </nav>
</glz-navbar>
```

**Features:**
- Landmark regions
- Keyboard navigation
- Mobile menu focus management
- ARIA expanded states

## Glassmorphism & Accessibility

### Contrast Considerations

Glass effects can reduce contrast. Glaze addresses this:

```css
/* Ensure minimum contrast on glass backgrounds */
.glz-glass {
  /* Dark text on light glass */
  --glz-glass-text: var(--glz-color-contrast-primary);
  
  /* Increased opacity for better readability */
  --glz-glass-tint-accessible: rgba(255, 255, 255, 0.85);
}
```

### Reduced Transparency Mode

For users who need better contrast:

```javascript
// Enable reduced transparency globally
document.body.setAttribute('data-reduced-transparency', 'true');

// Check user preference
if (window.matchMedia('(prefers-reduced-transparency: reduce)').matches) {
  document.body.setAttribute('data-reduced-transparency', 'true');
}
```

### High Contrast Theme

Specifically designed for accessibility:

```html
<body data-theme="high-contrast">
  <!-- Minimal transparency -->
  <!-- Maximum contrast ratios -->
  <!-- Stronger borders -->
</body>
```

## Keyboard Navigation

### Focus Management

All Glaze components support keyboard navigation:

| Key | Action |
|-----|--------|
| `Tab` | Move focus forward |
| `Shift + Tab` | Move focus backward |
| `Enter` | Activate button/link |
| `Space` | Activate button/checkbox |
| `Arrow Keys` | Navigate menus/lists |
| `Escape` | Close dialog/dropdown |
| `Home/End` | Jump to first/last item |

### Focus Indicators

Custom focus styles that work with glassmorphism:

```css
/* High visibility focus indicator */
:focus-visible {
  outline: 2px solid var(--glz-color-focus);
  outline-offset: 2px;
  border-radius: var(--glz-radius-sm);
}

/* For glass components */
.glz-glass:focus-visible {
  box-shadow: 
    0 0 0 2px var(--glz-color-focus),
    var(--glz-elevation-glass);
}
```

## Screen Reader Support

### Live Regions

Dynamic content updates announced:

```html
<!-- Status messages -->
<div role="status" aria-live="polite">
  Form saved successfully
</div>

<!-- Important alerts -->
<div role="alert" aria-live="assertive">
  Error: Invalid email address
</div>
```

### Descriptive Labels

Provide context for screen reader users:

```html
<glz-button
  aria-label="Delete item: Project Alpha"
  aria-describedby="delete-warning"
>
  <svg aria-hidden="true"><!-- trash icon --></svg>
  Delete
</glz-button>
<span id="delete-warning" class="sr-only">
  This action cannot be undone
</span>
```

## Testing for Accessibility

### Automated Testing

Use Storybook's a11y addon for automated checks:

```javascript
// In your story
export const AccessibleButton = {
  args: { /* ... */ },
  parameters: {
    a11y: {
      config: {
        rules: {
          // Component-specific rule overrides
        }
      }
    }
  }
};
```

### Manual Testing Checklist

1. **Keyboard Testing**
   - Navigate using only keyboard
   - Check focus order is logical
   - Ensure no keyboard traps
   - Verify all functions accessible

2. **Screen Reader Testing**
   - Test with NVDA (Windows)
   - Test with VoiceOver (macOS/iOS)
   - Test with TalkBack (Android)
   - Verify announcements make sense

3. **Visual Testing**
   - Zoom to 200%
   - Test with Windows High Contrast
   - Check color contrast ratios
   - Verify focus indicators visible

4. **Cognitive Testing**
   - Clear error messages
   - Consistent navigation
   - No unexpected changes
   - Simple, clear language

## Resources

### Tools
- [axe DevTools](https://www.deque.com/axe/devtools/)
- [WAVE](https://wave.webaim.org/)
- [Lighthouse](https://developers.google.com/web/tools/lighthouse)
- [Storybook a11y addon](https://storybook.js.org/addons/@storybook/addon-a11y)

### Guidelines
- [WCAG 2.2](https://www.w3.org/WAI/WCAG22/quickref/)
- [ARIA Authoring Practices](https://www.w3.org/WAI/ARIA/apg/)
- [WebAIM](https://webaim.org/)

### Testing
- [Screen Reader Testing Guide](https://webaim.org/articles/screenreader_testing/)
- [Keyboard Testing Guide](https://webaim.org/articles/keyboard/)

## Accessibility Statement

Glaze Design System is committed to ensuring digital accessibility for all users, including those with disabilities. We continually improve the user experience for everyone and apply the relevant accessibility standards.

If you encounter any accessibility barriers, please contact us for assistance.